{% extends 'base.html' %}

{% block title %}Courses - USIU LMS{% endblock %}

{% block content %}
<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
    <h2>All Courses</h2>
    {% if user.is_authenticated and user.is_instructor %}
    <a href="{% url 'course_create' %}"
       style="padding: 0.75rem 1.5rem; background-color: #2ecc71; color: white; text-decoration: none; border-radius: 4px; font-weight: 500;">
        Create Course
    </a>
    {% endif %}
</div>

<div class="card" style="margin-bottom: 2rem;">
    <form method="get" style="display: flex; gap: 0.5rem;">
        <input type="text" name="search" value="{{ search_query }}" placeholder="Search courses..."
               style="flex: 1; padding: 0.75rem; border: 1px solid #ddd; border-radius: 4px; font-size: 1rem;">
        <button type="submit"
                style="padding: 0.75rem 1.5rem; background-color: #3498db; color: white; border: none; border-radius: 4px; cursor: pointer;">
            Search
        </button>
    </form>
</div>

{% if courses %}
<div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1.5rem;">
    {% for course in courses %}
    <div class="card" style="display: flex; flex-direction: column;">
        {% if course.thumbnail %}
        <img src="{{ course.thumbnail.url }}" alt="{{ course.title }}"
             style="width: 100%; height: 200px; object-fit: cover; border-radius: 8px 8px 0 0; margin: -2rem -2rem 1rem -2rem;">
        {% else %}
        <div style="width: 100%; height: 200px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 8px 8px 0 0; margin: -2rem -2rem 1rem -2rem; display: flex; align-items: center; justify-content: center; color: white; font-size: 3rem;">
            ðŸ“š
        </div>
        {% endif %}

        <h3 style="margin-bottom: 0.5rem;">{{ course.title }}</h3>
        <p style="color: #7f8c8d; font-size: 0.875rem; margin-bottom: 0.5rem;">{{ course.code }}</p>
        <p style="color: #555; margin-bottom: 1rem; flex: 1;">
            {{ course.description|truncatewords:20 }}
        </p>

        <div style="border-top: 1px solid #e0e0e0; padding-top: 1rem; margin-top: auto;">
            <p style="font-size: 0.875rem; color: #7f8c8d; margin-bottom: 0.5rem;">
                <strong>Instructor:</strong> {{ course.instructor.get_full_name|default:course.instructor.username }}
            </p>
            <p style="font-size: 0.875rem; color: #7f8c8d; margin-bottom: 1rem;">
                <strong>Enrolled:</strong> {{ course.enrolled_count }} / {{ course.max_students }}
            </p>
            <a href="{% url 'course_detail' course.id %}"
               style="display: block; text-align: center; padding: 0.75rem; background-color: #3498db; color: white; text-decoration: none; border-radius: 4px;">
                View Details
            </a>
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="card" style="text-align: center; padding: 3rem;">
    <p style="font-size: 1.125rem; color: #7f8c8d;">
        {% if search_query %}
            No courses found matching "{{ search_query }}".
        {% else %}
            No courses available yet.
        {% endif %}
    </p>
</div>
{% endif %}
{% endblock %}
