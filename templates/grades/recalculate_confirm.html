{% extends 'base.html' %}

{% block title %}Recalculate Grades - USIU LMS{% endblock %}

{% block content %}
<div style="max-width: 600px; margin: 0 auto;">
    <div style="margin-bottom: 1rem;">
        <a href="{% url 'course_gradebook' course.id %}" style="color: #3498db; text-decoration: none;">‚Üê Back to Gradebook</a>
    </div>

    <div class="card">
        <h2 style="margin-bottom: 1.5rem;">Recalculate All Grades</h2>

        <div style="background-color: #d1ecf1; padding: 1rem; border-radius: 4px; border-left: 4px solid #17a2b8; margin-bottom: 1.5rem;">
            <p style="color: #0c5460; font-weight: 500;">Course: {{ course.code }} - {{ course.title }}</p>
            <p style="color: #0c5460; font-size: 0.875rem; margin-top: 0.5rem;">
                This will recalculate grades for all enrolled students based on their current assignment scores.
                Grades with manual overrides will not be affected.
            </p>
        </div>

        <form method="post">
            {% csrf_token %}

            {% if form.non_field_errors %}
            <div style="background-color: #f8d7da; padding: 1rem; border-radius: 4px; margin-bottom: 1rem; color: #721c24;">
                {{ form.non_field_errors }}
            </div>
            {% endif %}

            <div style="margin-bottom: 1.5rem;">
                <label style="display: flex; align-items: start; cursor: pointer;">
                    {{ form.confirm }}
                    <span style="margin-left: 0.5rem;">{{ form.confirm.label }}</span>
                </label>
                {% if form.confirm.errors %}
                <p style="color: #e74c3c; font-size: 0.875rem; margin-top: 0.25rem;">{{ form.confirm.errors.0 }}</p>
                {% endif %}
            </div>

            <div style="margin-bottom: 1.5rem;">
                <label style="display: flex; align-items: start; cursor: pointer;">
                    {{ form.notify_students }}
                    <span style="margin-left: 0.5rem;">{{ form.notify_students.label }}</span>
                </label>
                <p style="color: #7f8c8d; font-size: 0.875rem; margin-left: 1.75rem; margin-top: 0.25rem;">
                    (Email notifications are not yet implemented)
                </p>
            </div>

            <div style="display: flex; gap: 1rem; border-top: 1px solid #e0e0e0; padding-top: 1.5rem;">
                <button type="submit" style="flex: 1; padding: 1rem; background-color: #2ecc71; color: white; border: none; border-radius: 4px; font-weight: 500; cursor: pointer; font-size: 1rem;">
                    Recalculate Grades
                </button>
                <a href="{% url 'course_gradebook' course.id %}"
                   style="flex: 1; text-align: center; padding: 1rem; background-color: #95a5a6; color: white; text-decoration: none; border-radius: 4px; font-weight: 500;">
                    Cancel
                </a>
            </div>
        </form>
    </div>
</div>

<style>
    input[type="checkbox"] {
        width: 1.25rem;
        height: 1.25rem;
        cursor: pointer;
    }
</style>
{% endblock %}
